(function(){var a;a=angular.module("ngPostMessage",["ng"]),a.directive("html",["$window","$postMessage",function(a,b){return{restrict:"E",controller:["$scope",function(a){return a.$on("outgoingMessage",function(b,c){return a.sender?a.sender.postMessage(c,"*"):void 0})}],link:function(c){return c.sendMessageToService=function(a){var d,f;if(a=a.originalEvent||a,a&&a.data){f=null,c.sender=a.source;try{f=angular.fromJson(e.data)}catch(g){d=g,f=a.data}return b.messages(f)}},angular.element(a).bind("message",c.sendMessageToService)}}}]),a.factory("$postMessage",["$rootScope",function(a){var b,c;return b=[],c={messages:function(c){return c&&(b.push(c),a.$digest()),b},lastMessage:function(){return b[b.length-1]},post:function(b){return a.$broadcast("outgoingMessage",b)}}}])}).call(this);